## セットアップ

```bash
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
uv self update

# numbaがpyhton10以下である必要がある。
pyenv.bat install 3.10.11
pyenv.bat local 3.10.11

uv python pin 3.10.11   
uv init
uv add -r .\requirements.txt
```

## Web UIを起動
```bash
uv run .\webui.py
```
↑これを実行しないとパスが通らない。


```
# GPT_SoVITS/pretrained_modelsフォルダで、gsv-v2final-pretrainedを作成し、https://huggingface.co/lj1995/GPT-SoVITS/tree/main/gsv-v2final-pretrainedからファイルをダウンロード
# chinese-roberta-wwm-ext-largeを作成し、https://huggingface.co/lj1995/GPT-SoVITS/tree/main/chinese-roberta-wwm-ext-largeからダウンロード
# chinese-hubert-baseを作成し、https://huggingface.co/lj1995/GPT-SoVITS/tree/main/chinese-hubert-baseからダウンロード
# models--nvidia--bigvgan_v2_24khz_100band_256xを作成し、https://huggingface.co/lj1995/GPT-SoVITS/tree/main/models--nvidia--bigvgan_v2_24khz_100band_256xからダウンロード
# hugging faceからダウンロードするときに、ファイル名にエスケープが混入するようなので、リネーム
```


## CLIで変換
```bash
# GPT_SoVITS/test_dataに ref_audio.wav, ref_text.txt, target_text.txt を配置して
uv run .\GPT_SoVITS\inference_webui.py
```


# ファインチューニング
## 0b-音声分割ツール
例えば、あみたろの場合はITAコーパスのemotionとrecitationをフォルダに追加して、パスに指定。
```
C:\Users\mail2\Downloads\音声データ\gpt-sovits-train\amitaro
```

実行すると、GPT-Sovitsのフォルダにoutput/slicer_optというフォルダが作成され、分割後ファイルが格納される。
また、0bb-音声ノイズ除去ツールの入力フォルダにoutput/slicer_optが設定される。

## 0bb-音声ノイズ除去ツール
あみたろの音声の場合は必要なさそうだが、一応実行する。
完了すると、GPT-Sovitsのフォルダにoutput\denoise_optというフォルダが作成され、分割後ファイルが格納される。
また、0c-音声認識ツールの入力フォルダにoutput\denoise_optが設定される。

## 0c-音声認識ツール
faster-whisperでlarge-v3等で音声認識
完了すると、GPT-Sovitsのフォルダにoutput/asr_optというフォルダが作成され、分割後ファイルが格納される。
また、0d-音声テキスト校正・ラベル付けツールの入力フォルダにoutput\asr_opt\denoise_opt.listが設定される。

## 0d-音声テキスト校正・ラベル付けツール
実行するとエディタが立ち上がるが、とりあえず無視。

## 1-GPT-SoVITS-TTS
ｖ３ではDiscriminaterはいらない？？


## 1Aa-テキスト分割と特徴抽出
実行すると、logs\あみたろv1\2-name2text.txt, 3-bertなどに出力

## 1Ab-音声自己教師あり特徴抽出
実行すると、logs\あみたろv1\4-cnhubert, 5-wav32kなどに出力

## 1Ac-セマンティックトークン抽出
実行すると、logs\あみたろv1\6-name2semantic.tsvなどに出力

## 1B ファインチューニング
## 1Ba-SoVITS トレーニング: モデルの重みファイルは SoVITS_weights/ にあります
実行するとSoVITS_weights_v3に出力されるようだ。
## 1Bb-GPT トレーニング: モデルの重みファイルは GPT_weights/ にあります
実行するとGPT_weights_v3に出力されるようだ。


## 1C 推論